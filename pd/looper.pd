#N canvas 0 32 1680 969 12;
#X declare -path bin;
#X declare -path bin64;
#X msg 6245 669 \; pd dsp 1;
#X msg 6244 709 \; pd dsp 0;
#X obj 308 2873 hsl 128 15 0 1 0 1 empty empty output-level 20 8 0 10 #fcfcfc #fc8000 #000000 8900 0;
#X floatatom 312 2906 5 0 0 0 - - - 0;
#X obj 6245 640 loadbang;
#X obj 270 2155 hsl 300 20 -4 4 0 1 empty empty writing-and-reading-speed 100 10 0 10 #fcfcfc #fc8000 #000000 18700 0;
#X obj 789 2668 hip~ 5;
#X floatatom 338 2186 4 0 0 0 - - - 0;
#X obj 661 417 hsl 395 64 0 151040 0 0 empty \$0-slider empty -2 -8 0 10 #fcfcfc #fc8000 #000000 0 1;
#X msg 6489 690 const 0;
#X text 338 2804 direct out;
#X obj 830 2645 hsl 64 15 0 1 0 1 empty empty feedback 5 8 0 10 #fcfcfc #fc8000 #000000 4365 0;
#N canvas 1 51 420 192 searchpatch 0;
#X obj 36 95 declare -path bin;
#X obj 36 129 declare -path bin64;
#X text 34 31 Find path to [ipoke~] executables. If you want to use [ipoke~] in your own patches \, copy or move the executable for your platform in Pd's 'extra' directory.;
#X restore 2203 75 pd searchpatch;
#N canvas 0 22 180 176 dac~ 0;
#X obj 18 34 inlet~;
#X obj 18 102 dac~;
#X obj 18 70 *~ 0;
#X obj 78 34 inlet;
#X connect 0 0 2 0;
#X connect 2 0 1 0;
#X connect 2 0 1 1;
#X connect 3 0 2 1;
#X restore 256 2906 pd dac~;
#X obj 408 2501 tgl 25 1 empty empty empty 17 7 0 10 #fcfcfc #fc8000 #000000 1 1;
#X text 358 2534 draw;
#X obj 307 2802 tgl 25 1 empty empty empty 17 7 0 10 #fcfcfc #fc8000 #000000 0 0.7;
#X text 551 2911 Variable speed sound on sound looping delay \, tested with soundfile (.wav or .aiff). It works particularly nice with drumloops.;
#N canvas 295 320 450 300 (subpatch) 0;
#X array \$0-ipokebuf 151040 float 2;
#X coords 0 1 151040 -1 400 64 1;
#X restore 659 417 graph;
#X text 552 2965 Be careful with high feedback settings if the soundfile is still playing \, there is no limiter included in this patch.;
#X text 6543 690 clear buffer;
#X obj 274 2836 *~ 0.7;
#X obj 789 2700 *~ 0.7;
#X text 552 3006 If you experience nasty clicks or dropouts \, it may be caused by the array's visual update. Disable the 'draw' toggle.;
#X obj 91 628 hsl 128 15 0 2 0 1 empty empty input-gain 20 8 0 10 #fcfcfc #fc8000 #000000 4600 1;
#N canvas 572 171 217 211 adc 0;
#X obj 60 13 inlet;
#X obj 39 48 *~ 1;
#X obj 39 129 s~ \$0-input;
#X obj 18 13 adc~;
#X obj 123 130 outlet;
#X obj 123 100 env~ 2048;
#X connect 0 0 1 1;
#X connect 1 0 2 0;
#X connect 1 0 5 0;
#X connect 3 0 1 0;
#X connect 3 1 1 0;
#X connect 5 0 4 0;
#X restore 88 676 pd adc;
#X floatatom 99 653 5 0 0 0 - - - 0;
#X obj 769 2725 r~ \$0-input;
#X obj 769 2757 +~;
#X obj 961 2622 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 961 2683 t i i;
#X obj 1023 2707 sel 1;
#X obj 1026 2767 line~;
#X obj 768 2790 *~;
#X obj 274 2771 r~ \$0-input;
#X text 988 2623 record;
#X obj 925 2762 *~;
#X obj 943 2790 +~;
#X obj 961 2709 != 1;
#X obj 961 2735 sig~ -1;
#X obj 961 2761 *~;
#X msg 1025 2735 0 \, 1 10 \;;
#X msg 1099 2734 0 10 \;;
#X obj 660 617 vu 15 80 \$0-input-meter empty -1 -10 0 10 #404040 #000000 1 0;
#X obj 88 703 - 90;
#X obj 2829 1753 soundfiler;
#X text 140 44 todo: can we make sure that we init to a 44.1k sample rate?;
#X obj 2896 1796 t b;
#X obj 3763 1915 loadbang;
#X obj 2575 1092 route process-result error;
#X obj 2835 1612 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 2576 1413 soundfiler;
#X obj 3830 1916 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 2755 1147 print other-msg;
#X obj 3754 2029 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X msg 3827 1970 disconnect;
#X msg 3763 1941 connect localhost 8001;
#X obj 2896 1849 symbol;
#X msg 2895 1824 buf.wav;
#X obj 2895 1876 oscformat /process;
#X obj 2895 1904 list prepend send;
#X obj 2895 1928 list trim;
#X obj 3754 1999 netsend -u -b;
#X obj 2576 1039 oscparse;
#X obj 2576 997 netreceive -u -b 8002;
#X obj 2764 1123 print process-result;
#X obj 2673 1410 print readmsg;
#X obj 2575 1065 list trim;
#X obj 2576 1137 symbol;
#X obj 2649 1440 print read;
#X obj 3737 1520 list prepend send;
#X obj 3737 1544 list trim;
#X obj 4180 1431 oscformat /seed;
#X obj 663 332 hsl 395 64 0 151040 0 0 empty \$0-slider empty -2 -8 0 10 #fcfcfc #fc8000 #000000 0 1;
#N canvas 295 320 450 300 (subpatch) 0;
#X array \$0-wetpokebuf 151040 float 2;
#X coords 0 1 151040 -1 400 64 1;
#X restore 659 332 graph;
#X obj 787 2105 loadbang;
#X text 210 2000 audio processing;
#X text 594 444 dry buf;
#X text 2717 1613 gloop button;
#X text 2964 1829 /process;
#X text 3533 1528 OSC controls (4 backend);
#X text 2759 996 osc receive;
#X floatatom 657 506 5 0 0 3 c-periodic \$0_codes_periodic_prompt_UI \$0_codes_periodic_prompt 0;
#X obj 258 2724 expr~ ($v1*(1-$v3*$v3)) + ($v2*($v3*$v3));
#X obj 542 2678 hsl 128 15 0 1 0 1 empty empty xfade 20 8 0 10 #fcfcfc #fc8000 #000000 8600 0;
#X obj 266 2488 phasor~;
#X obj 266 2514 *~ 88200;
#N canvas 329 481 282 268 draw 0;
#X obj 29 168 snapshot~;
#X obj 29 225 s \$0-draw;
#X obj 29 196 bang;
#X obj 183 103 metro 500;
#X obj 29 10 inlet~;
#X obj 183 -2 inlet;
#X obj 80 80 snapshot~;
#X obj 80 106 s \$0-slider;
#X obj 80 51 metro 50;
#X obj 80 26 tgl 15 1 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 1 1;
#X connect 0 0 2 0;
#X connect 2 0 1 0;
#X connect 3 0 0 0;
#X connect 4 0 0 0;
#X connect 4 0 6 0;
#X connect 5 0 3 0;
#X connect 6 0 7 0;
#X connect 8 0 6 0;
#X connect 9 0 8 0;
#X restore 363 2558 pd draw;
#X floatatom 725 2304 10 44032 440832 0 - - - 0;
#X obj 3633 3091 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 3634 3121 sel 1 0;
#X msg 314 2459 0;
#X text 3960 3200 momentary record circuit - on 0->1 \, reset to max size \, clear buffer \, move playhead to 0 \, record enable and play - on 1->0 \, cut buffer to current len \, record disable, f 27;
#X text 850 2171 maxbuffer size;
#X text 811 2311 buffer size;
#X obj 873 2139 print maxbufsize;
#X obj 726 2376 s \$0-slider;
#X obj 268 2388 *;
#X obj 280 2412 s \$0-Hz;
#X msg 726 2346 range 0 \$1;
#X floatatom 726 2242 10 44032 440832 0 - - - 0;
#X text 807 2239 requested bufsize;
#X obj 761 2106 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 788 2145 441000;
#X obj 267 2107 loadbang;
#X floatatom 419 2117 4 0 0 0 - - - 0;
#X obj 419 2090 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 338 2212 set \$1;
#X obj 176 2154 t 0 b;
#X obj 3423 3153 t b b b b b b b;
#X msg 3440 3286 1;
#X obj 475 2548 snapshot~;
#X obj 475 2521 r \$0-sample-pos-bang;
#X obj 475 2572 s \$0-sample-pos;
#X obj 961 2585 r \$0-rec-toggle;
#X obj 315 2435 r \$0-reset-phasor;
#X obj 177 2039 r \$0-pause;
#X obj 419 2065 r \$0-play;
#X obj 3463 3263 s \$0-pause;
#X obj 3476 3238 s \$0-reset-phasor;
#X obj 3490 3214 s \$0-clearbuffer;
#X obj 3505 3189 s \$0-maxbufsize;
#X obj 873 2106 r \$0-maxbufsize;
#X obj 3424 3338 s \$0-play;
#X obj 3794 3196 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 3794 3220 s \$0-sample-pos-bang;
#X obj 3794 3244 r \$0-sample-pos;
#X obj 3791 3270 s \$0-request-bufsize;
#X obj 728 2210 r \$0-request-bufsize;
#X msg 3679 3196 0;
#X obj 788 2169 int;
#X floatatom 267 2210 5 0 0 0 - - - 0;
#X obj 3657 3155 t b b b;
#X obj 3650 3251 s \$0-reset-phasor;
#X obj 768 2819 ipoke~ \$0-ipokebuf;
#X obj 259 2643 tabread4~ \$0-ipokebuf, f 15;
#X obj 397 2643 tabread4~ \$0-wetpokebuf, f 20;
#X obj 6489 719 s \$0-ipokebuf;
#X obj 6598 718 s \$0-wetpokebuf;
#X obj 3440 3313 s \$0-rec-toggle;
#X obj 3679 3220 s \$0-rec-toggle;
#X obj 6489 627 r \$0-clearbuffer;
#X obj 810 2790 r \$0-draw;
#X obj 871 2345 array size \$0-ipokebuf;
#X obj 871 2372 array size \$0-wetpokebuf;
#X obj 6785 618 loadbang;
#X obj 6786 644 \$0;
#X obj 6786 692 r \$0-id;
#X obj 6761 617 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 6786 668 s \$0-id;
#X msg 2829 1729 write buf.wav \$1;
#X obj 2629 1283 r \$0-id;
#X obj 2629 1332 symbol;
#X msg 2629 1308 \$1-wetpokebuf;
#X msg 2576 1385 read \$1 \$2;
#X obj 2576 1358 pack s s;
#X obj 2683 1476 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 2643 1503 spigot;
#X obj 2643 1477 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 2710 1477 auto?;
#X obj 2792 1409 loadbang;
#X msg 2792 1433 0;
#X obj 3035 1685 spigot;
#X obj 3080 1589 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 3033 1586 == 0;
#X obj 2830 1686 spigot;
#X obj 3077 1530 loadbang;
#X msg 3077 1554 0;
#X text 3023 1354 feedback?;
#X obj 4701 1432 oscformat /temperature;
#X obj 2968 1753 print writemsg;
#X obj 3632 3061 r \$0-momentary-rec-toggle;
#X obj 2592 3059 notein;
#X text 2793 3131 velocity;
#X text 2784 3109 channel;
#X text 2791 3153 note;
#X floatatom 2759 3153 4 0 127 0 - - - 0;
#X floatatom 2759 3130 4 0 127 0 - - - 0;
#X floatatom 2759 3109 0 1 64 0 - - - 0;
#X text 2662 3065 *;
#X obj 2590 3124 pack 0 0;
#X obj 2589 3157 route 60 61;
#X obj 2589 3191 > 0;
#X obj 2589 3215 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X text 2882 3126 TEST FOOTSWITCHES;
#X obj 2629 3191 > 0;
#X obj 2629 3215 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 2589 3276 s \$0-momentary-rec-toggle;
#X obj 2655 3215 s \$0-gloop;
#X obj 2837 1577 r \$0-gloop;
#X text 1335 2754 daniel: should add EQ // effects!!!;
#X text 1342 2719 hugo: MIDI SYNC IS SO NECESSARY;
#X text 1339 2913 hugo: needs conditioning on density \, frequency \,;
#X obj 6248 148 midirealtimein;
#X floatatom 6248 172 5 0 0 0 - - - 0;
#X obj 6248 215 counter 0 0 5;
#X obj 6248 237 select 0;
#X obj 6248 463 bng 15 70 50 0 empty empty pulse\ (16ths) 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 6248 193 select 248 250 252;
#X obj 6283 322 bng 15 70 50 0 empty empty play 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 6318 346 bng 15 70 50 0 empty empty stop 17 7 0 10 #fcfcfc #000000 #000000;
#X floatatom 6442 232 5 0 0 0 BAR - - 0;
#X msg 6283 431 0;
#X text 6554 497 visual and sound indication with this basic 4/4 metronome;
#N canvas 0 25 1680 997 metro 0;
#X obj 101 -14 inlet, f 6;
#X obj 101 104 bng 15 70 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 121 104 bng 15 70 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 141 104 bng 15 70 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 161 104 bng 15 70 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X msg 101 174 1;
#X msg 131 174 2;
#X msg 161 174 3;
#X msg 191 174 4;
#X floatatom 111 125 5 0 0 3 METRONOME - - 0;
#X obj 101 82 loadbang;
#X obj 101 226 osc~;
#X msg 101 196 880;
#X msg 131 196 440;
#X obj 101 304 *~;
#X obj 116 275 line~;
#X obj 101 326 *~;
#X obj 181 104 vsl 15 47 0 127 0 0 empty empty empty 0 -9 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 331 306 / 127;
#X obj 101 348 dac~;
#X msg 116 253 1 \, 0 70;
#X obj 101 38 mod 16;
#X obj 101 60 select 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15;
#X obj 479 160 loadbang;
#X msg 479 182 0;
#X msg 511 183 70;
#X obj 101 12 f;
#X obj 138 12 + 1;
#X connect 0 0 26 0;
#X connect 1 0 5 0;
#X connect 1 0 20 0;
#X connect 2 0 6 0;
#X connect 2 0 20 0;
#X connect 3 0 7 0;
#X connect 3 0 20 0;
#X connect 4 0 8 0;
#X connect 4 0 20 0;
#X connect 5 0 9 0;
#X connect 5 0 12 0;
#X connect 6 0 9 0;
#X connect 6 0 13 0;
#X connect 7 0 9 0;
#X connect 7 0 13 0;
#X connect 8 0 9 0;
#X connect 8 0 13 0;
#X connect 10 0 1 0;
#X connect 11 0 14 0;
#X connect 12 0 11 0;
#X connect 13 0 11 0;
#X connect 14 0 16 0;
#X connect 15 0 14 1;
#X connect 16 0 19 0;
#X connect 16 0 19 1;
#X connect 17 0 18 0;
#X connect 18 0 16 1;
#X connect 20 0 15 0;
#X connect 21 0 22 0;
#X connect 22 0 1 0;
#X connect 22 4 2 0;
#X connect 22 8 3 0;
#X connect 22 12 4 0;
#X connect 23 0 5 0;
#X connect 23 0 24 0;
#X connect 23 0 25 0;
#X connect 24 0 14 1;
#X connect 25 0 17 0;
#X connect 26 0 27 0;
#X connect 26 0 21 0;
#X connect 27 0 26 1;
#X coords 0 -1 1 1 101 61 2 100 100;
#X restore 6430 500 pd metro;
#X text 6368 191 select is used as a filter to isolate the needed MIDI info;
#X obj 3583 3011 change;
#X obj 3583 3035 sel 1;
#X obj 3583 3059 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 3583 2960 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 3583 2987 > 0;
#X obj 3583 2931 r \$0-footswitch-style-rec;
#X obj 6248 508 sel 0;
#X obj 6248 532 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 6248 484 counter 0 3;
#X text 6267 532 pulse (4trs);
#X text 1333 2782 daniel: sounds too dark.;
#N canvas 295 320 450 300 cut-to-512-hop 0;
#X obj 284 113 int;
#X obj 285 80 expr ($f1 / 512);
#X obj 284 142 expr ($i1 * 512);
#X floatatom 284 171 10 44032 440832 0 - - - 0;
#X text 365 169 resulting bufsize;
#X text 413 80 ENSURE BUFSIZE IS A MULTIPLE OF HOP SIZE 512: hop size of the neural audio codec 44100: sample rate;
#X obj 284 194 outlet;
#X obj 284 51 inlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 7 0 1 0;
#X restore 726 2276 pd cut-to-512-hop;
#X obj 5991 245 tgl 19 0 empty empty sync 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 5843 249 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 5843 185 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X floatatom 5924 186 5 0 0 0 - - - 0;
#N canvas 382 407 450 300 metro-bpm 0;
#X obj 37 37 inlet;
#X obj 97 36 inlet;
#X obj 37 90 metro 100;
#X obj 97 63 expr 1000 * 60 / $f1;
#X obj 37 124 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 1;
#X restore 5843 218 pd metro-bpm;
#X text 5841 157 internal clock;
#X text 6250 111 external clock;
#X obj 2574 1238 cyclone/onebang;
#X obj 2577 1268 symbol;
#X obj 2574 1209 t b s;
#X text 2710 1240 only allow bang through if we haven't cleared the buffer or otherwise canceled it;
#X msg 2497 1206 stop;
#X text 2560 3010 MIDI CONTROL (salad bowl prototype);
#X text 1333 2832 hugo: you should be able to save them (to what? slots? banks? ), f 66;
#X text 599 354 wet buf;
#X text 2333 1262 undo circuit: before reading a new file \, save whatever's in the buffer to a backup buffer, f 25;
#N canvas 295 320 450 300 (subpatch) 0;
#X array \$0-undobuf 151040 float 2;
#X coords 0 1 151040 -1 100 32 1;
#X restore 2371 1460 graph;
#X obj 2367 1382 array get \$0-wetpokebuf;
#X obj 2367 1416 array set \$0-undobuf;
#X obj 2368 1351 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 2398 1349 save undo buffer;
#X obj 2193 1347 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 2215 1344 undo;
#X obj 2191 1418 array set \$0-wetpokebuf;
#X obj 2192 1383 array get \$0-undobuf;
#X obj 2577 1291 t s b;
#X obj 2490 1152 r \$0-gloop-cancel, f 9;
#X obj 6502 659 s \$0-gloop-cancel;
#X obj 871 2399 array size \$0-undobuf;
#N canvas 933 155 450 300 calc-phasor-freq 0;
#X obj 69 144 samplerate~;
#X obj 68 90 loadbang;
#X obj 68 183 / 88200;
#X obj 85 122 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X floatatom 179 80 10 0 0 0 - - - 0;
#X obj 176 106 t b i i;
#X obj 68 216 t b f;
#X obj 179 39 inlet;
#X obj 69 262 outlet;
#X obj 135 261 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 6 0;
#X connect 3 0 0 0;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 5 1 2 1;
#X connect 6 0 8 0;
#X connect 6 1 9 0;
#X connect 7 0 4 0;
#X restore 288 2357 pd calc-phasor-freq;
#X text 401 2193 if pause \, remember last playback speed for when we resume;
#N canvas 1049 271 450 300 ipokebufname 0;
#X msg 258 81 \$1-ipokebuf;
#X obj 257 110 symbol;
#X obj 258 52 r \$0-id, f 9;
#X obj 257 134 outlet;
#X obj 190 77 inlet;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 0 0;
#X connect 4 0 1 0;
#X restore 2833 1659 pd ipokebufname;
#N canvas 1078 300 450 300 wetpokebufname 0;
#X msg 182 104 \$1-wetpokebuf;
#X obj 151 144 symbol;
#X obj 183 78 r \$0-id, f 9;
#X obj 153 177 outlet;
#X obj 130 92 inlet;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 0 0;
#X connect 4 0 1 0;
#X restore 3035 1657 pd wetpokebufname;
#X text 822 2604 write circuit;
#X obj 6785 724 print the-id-of-this-patch-is;
#X obj 973 2653 s \$0-state-rec;
#X obj 5290 2619 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 5291 2722 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 5447 2720 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 5447 2653 5 0 0 0 thresh\ (ms) - - 0;
#X obj 5446 2626 loadbang;
#X text 5234 2724 short;
#N canvas 1136 358 452 389 sw-detect-long-press 0;
#X obj 100 148 timer;
#X obj 100 114 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 101 75 sel 1 0;
#X obj 131 114 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 100 178 5 0 0 0 - - - 0;
#X obj 100 205 > 500;
#X obj 100 233 sel 0 1;
#X obj 101 40 inlet;
#X obj 236 38 inlet;
#X text 90 15 toggle in;
#X text 223 9 long press threshold (ms);
#X obj 100 275 outlet;
#X obj 155 276 outlet;
#X text 94 301 short;
#X text 157 298 long;
#X connect 0 0 4 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 2 1 3 0;
#X connect 3 0 0 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 11 0;
#X connect 6 1 12 0;
#X connect 7 0 2 0;
#X connect 8 0 5 1;
#X restore 5289 2688 pd sw-detect-long-press;
#X floatatom 5313 2788 5 0 0 0 - - - 0;
#X obj 5295 2968 int;
#X msg 6777 3112 0;
#X obj 4868 3093 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 5395 3155 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 4895 3353 1;
#X obj 4918 3330 s \$0-pause;
#X obj 4931 3305 s \$0-reset-phasor;
#X obj 4945 3281 s \$0-clearbuffer;
#X obj 4960 3256 s \$0-maxbufsize;
#X obj 4879 3405 s \$0-play;
#X obj 4895 3380 s \$0-rec-toggle;
#X text 5395 3116 cut -> play;
#X text 4650 3223 momentary record circuit - on 0->1 \, reset to max size \, clear buffer \, move playhead to 0 \, record enable and play - on 1->0 \, cut buffer to current len \, record disable, f 27;
#X obj 5654 3414 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 5654 3445 s \$0-sample-pos-bang;
#X obj 5654 3469 r \$0-sample-pos;
#X obj 5651 3495 s \$0-request-bufsize;
#X msg 5398 3500 0;
#X obj 5395 3193 t b b b;
#X obj 5129 3457 s \$0-reset-phasor;
#X obj 5398 3524 s \$0-rec-toggle;
#X obj 6088 3196 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 4898 3092 1;
#X msg 5430 3151 2;
#X text 6067 3160 overdub on;
#X obj 6093 3267 t b;
#X msg 6093 3291 1;
#X obj 6092 3320 s \$0-rec-toggle;
#X text 4935 3092 next state: cut-play;
#X text 5472 3152 next state: overdub on;
#X text 6158 3187 next state: overdub off;
#X msg 6120 3198 3;
#X obj 5293 2998 sel 0 1 2 3;
#X obj 6459 3182 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 6464 3253 t b;
#X obj 6463 3306 s \$0-rec-toggle;
#X msg 6464 3277 0;
#X msg 6491 3184 2;
#X text 6529 3173 next state: overdub on;
#X obj 6749 3114 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 6757 3190 t b b b b b b b;
#X obj 6797 3300 s \$0-pause;
#X obj 6810 3275 s \$0-reset-phasor;
#X obj 6824 3251 s \$0-clearbuffer;
#X obj 6839 3226 s \$0-maxbufsize;
#X text 6743 3077 RESET;
#X obj 650 752 tgl 30 0 \$0-ditto-style-rec-sw empty footswitch\ (ditto) 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X text 6441 3146 overdub off;
#X obj 4898 3116 s \$0-state-dittosw;
#X obj 5310 2762 r \$0-state-dittosw;
#X obj 5430 3175 s \$0-state-dittosw;
#X obj 6120 3222 s \$0-state-dittosw;
#X obj 6491 3208 s \$0-state-dittosw;
#X msg 4894 2953 ready;
#X obj 4886 2827 sel 0 1 2 3;
#X obj 6777 3136 s \$0-state-dittosw;
#X obj 643 2575 cyclone/edge~;
#X obj 643 2602 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 643 2626 s \$0-loop-done;
#X obj 5652 3379 cyclone/onebang;
#X msg 5736 3349 stop;
#X obj 5130 3396 cyclone/onebang;
#X msg 5159 3366 stop;
#X obj 5158 3339 r \$0-loop-done;
#X obj 4864 3144 t b b b b b b b b;
#X obj 5124 3176 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 5130 3420 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 5610 3281 dont cut buffer if we've already done a full loop, f 34;
#X obj 5735 3321 r \$0-loop-done;
#X obj 5415 3417 r \$0-loop-done;
#X obj 5414 3450 cyclone/onebang;
#X msg 5462 3390 stop;
#X text 5392 3299 if loop done and we havent changed state \, still turn off recording. if we change state \, don't allow any bangs through, f 25;
#X msg 4806 2861 set ready;
#X msg 4888 2862 set playing;
#X msg 4986 2862 set overdub;
#X msg 5080 2864 set playing;
#X obj 1064 736 r \$0-state-ext-ditto;
#X msg 1064 760 ready;
#X obj 4998 2956 s \$0-state-ext-ditto;
#X text 4906 2780 STATE FRONTEND;
#X text 4881 2641 state: 0: ready (then \, we record) 1: playing (then \, we overdub) 2: overdubbing (then \, we disable overdub) 3: overdub off;
#X text 5500 2712 long press: RESET;
#X text 5148 3150 this bang allows for stage 2 to happen, f 19;
#X text 5166 3272 dont force reset phasor if we've already looped, f 22;
#X obj 5290 2590 r \$0-ditto-style-rec-sw;
#X text 4730 3100 STAGE 1 init -> record;
#X text 5396 3098 STAGE 2;
#X text 6065 3138 STAGE 3;
#X text 6446 3126 STAGE 4;
#X text 1336 2868 hugo: need to implement overdub // delete on a footswitch (done \, ditto style footswtich);
#X obj 3986 1940 list prepend send;
#X obj 3986 1964 list trim;
#X text 4122 1936 get a list of available params;
#X obj 4418 1431 oscformat /codes_upper_codebook_mask;
#X obj 3987 1894 oscformat /get_params;
#X obj 3415 1425 oscformat /codes_periodic_prompt;
#X obj 3904 1427 oscformat /controls_periodic_prompt;
#X obj 3985 1855 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 4896 1404 5 0 0 0 - - - 0;
#X obj 4896 1431 oscformat /typical_mass;
#X obj 4960 1399 r \$0-parambang;
#X obj 831 747 tgl 30 0 \$0-momentary-rec-toggle empty toggle\ (momentary) 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X floatatom 3415 1393 5 0 0 0 - - - 0;
#X obj 3459 1389 r \$0-parambang;
#X floatatom 748 507 5 0 0 3 ctrls-p \$0_controls_periodic_prompt_UI \$0_controls_periodic_prompt 0;
#X floatatom 657 558 5 0 0 3 ucm \$0_codes_upper_codebook_mask_UI \$0_codes_upper_codebook_mask 0;
#X floatatom 1010 507 5 0 0 3 seed \$0_seed_UI \$0_seed 0;
#X floatatom 899 506 5 0 0 3 temperature \$0_temperature_UI \$0_temperature 0;
#X floatatom 895 560 5 0 0 3 typical\ mass \$0_typical_mass_UI \$0_typical_mass 0;
#X obj 3415 1361 r \$0_codes_periodic_prompt;
#X floatatom 3906 1401 5 0 0 0 - - - 0;
#X obj 3957 1400 r \$0-parambang;
#X obj 3906 1365 r \$0_controls_periodic_prompt;
#X floatatom 4180 1394 5 0 0 0 - - - 0;
#X obj 4228 1393 r \$0-parambang;
#X obj 4179 1360 r \$0_seed;
#X floatatom 4420 1393 5 0 0 0 - - - 0;
#X obj 4470 1392 r \$0-parambang;
#X obj 4420 1358 r \$0_codes_upper_codebook_mask;
#X floatatom 4699 1402 5 0 0 0 - - - 0;
#X obj 4744 1400 r \$0-parambang;
#X obj 643 2549 cyclone/>=~;
#X obj 716 2521 sig~ 0.99;
#X obj 3869 862 pack \$0;
#X obj 3870 834 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 3639 829 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 3674 826 loadbang;
#X obj 3638 862 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 4699 1367 r \$0_temperature;
#X obj 4892 1359 r \$0_typical_mass;
#X obj 3638 886 s \$0-parambang;
#X obj 3871 802 loadbang;
#X obj 1705 2195 soundfiler;
#X obj 1705 2116 openpanel;
#X obj 1705 2081 bng 19 250 50 0 empty empty empty 17 7 0 10 #dfdfdf #000000 #000000;
#X obj 1792 2196 print load-from-file-msg;
#X obj 1705 2139 pack s \$0;
#X floatatom 1705 2218 5 0 0 0 - - - 0;
#X obj 1705 2240 s \$0-request-bufsize;
#X msg 1705 2162 read -resize \$1 \$2-ipokebuf;
#X obj 834 652 bng 30 250 50 0 \$0-gloop empty gloop 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 2840 1434 r \$0-auto;
#X obj 1009 570 tgl 30 0 \$0-auto empty auto 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 88 727 s \$0-input-meter;
#X obj 1704 2053 r \$0-load-from-file;
#X obj 657 836 bng 19 250 50 0 \$0-load-from-file empty load\ file 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 747 554 5 0 0 3 ctrl\ drop \$0_controls_drop_amt_UI \$0_controls_drop_amt 0;
#X floatatom 3666 1396 5 0 0 0 - - - 0;
#X obj 3717 1395 r \$0-parambang;
#X obj 3664 1422 oscformat /controls_drop_amt;
#X obj 3666 1360 r \$0_controls_drop_amt;
#X msg 3868 890 \; \$1_codes_periodic_prompt_UI 0 \; \$1_controls_periodic_prompt_UI 7 \; \$1_controls_drop_amt_UI 0.15 \; \$1_seed_UI -1 \; \$1_codes_upper_codebook_mask_UI 4 \; \$1_temperature_UI 1 \; \$1_typical_mass_UI 0.15;
#X connect 2 0 3 0;
#X connect 2 0 13 1;
#X connect 4 0 0 0;
#X connect 5 0 7 0;
#X connect 5 0 131 0;
#X connect 6 0 22 0;
#X connect 7 0 107 0;
#X connect 9 0 137 0;
#X connect 9 0 138 0;
#X connect 11 0 22 1;
#X connect 14 0 87 1;
#X connect 16 0 21 1;
#X connect 21 0 13 0;
#X connect 22 0 28 1;
#X connect 24 0 25 0;
#X connect 24 0 26 0;
#X connect 25 0 44 0;
#X connect 27 0 28 0;
#X connect 28 0 33 0;
#X connect 29 0 30 0;
#X connect 29 0 253 0;
#X connect 30 0 36 1;
#X connect 30 0 38 0;
#X connect 30 1 31 0;
#X connect 31 0 41 0;
#X connect 31 1 42 0;
#X connect 32 0 33 1;
#X connect 34 0 21 0;
#X connect 36 0 37 0;
#X connect 38 0 40 1;
#X connect 39 0 40 0;
#X connect 40 0 37 1;
#X connect 41 0 32 0;
#X connect 42 0 32 0;
#X connect 44 0 406 0;
#X connect 45 1 47 0;
#X connect 47 0 58 0;
#X connect 48 0 56 0;
#X connect 49 0 68 0;
#X connect 49 0 65 0;
#X connect 49 2 53 0;
#X connect 50 0 225 1;
#X connect 50 0 249 0;
#X connect 50 0 250 0;
#X connect 51 1 69 0;
#X connect 51 1 158 0;
#X connect 52 0 56 0;
#X connect 55 0 62 0;
#X connect 56 0 62 0;
#X connect 57 0 59 0;
#X connect 58 0 57 0;
#X connect 59 0 60 0;
#X connect 60 0 61 0;
#X connect 61 0 62 0;
#X connect 62 0 54 0;
#X connect 63 0 67 0;
#X connect 64 0 63 0;
#X connect 67 0 49 0;
#X connect 68 0 227 0;
#X connect 70 0 71 0;
#X connect 71 0 62 0;
#X connect 72 0 70 0;
#X connect 75 0 103 0;
#X connect 83 0 13 0;
#X connect 84 0 83 2;
#X connect 85 0 86 0;
#X connect 85 0 384 0;
#X connect 86 0 87 0;
#X connect 86 0 36 0;
#X connect 86 0 111 0;
#X connect 86 0 135 0;
#X connect 86 0 136 0;
#X connect 88 0 99 0;
#X connect 88 0 143 0;
#X connect 88 0 144 0;
#X connect 88 0 246 0;
#X connect 88 0 247 0;
#X connect 88 0 86 1;
#X connect 89 0 90 0;
#X connect 90 0 109 0;
#X connect 90 1 132 0;
#X connect 91 0 85 1;
#X connect 97 0 98 0;
#X connect 97 0 85 0;
#X connect 99 0 96 0;
#X connect 100 0 217 0;
#X connect 102 0 103 0;
#X connect 103 0 130 0;
#X connect 104 0 5 0;
#X connect 105 0 5 0;
#X connect 106 0 105 0;
#X connect 107 0 105 0;
#X connect 108 0 131 0;
#X connect 108 1 7 0;
#X connect 109 0 123 0;
#X connect 109 1 110 0;
#X connect 109 2 118 0;
#X connect 109 3 119 0;
#X connect 109 4 120 0;
#X connect 109 5 121 0;
#X connect 110 0 139 0;
#X connect 111 0 113 0;
#X connect 112 0 111 0;
#X connect 114 0 29 0;
#X connect 115 0 91 0;
#X connect 116 0 108 0;
#X connect 117 0 106 0;
#X connect 122 0 95 0;
#X connect 122 0 103 0;
#X connect 124 0 125 0;
#X connect 126 0 127 0;
#X connect 128 0 100 0;
#X connect 129 0 140 0;
#X connect 130 0 100 0;
#X connect 131 0 97 0;
#X connect 132 0 133 0;
#X connect 132 1 129 0;
#X connect 132 2 124 0;
#X connect 135 0 6 0;
#X connect 135 0 83 0;
#X connect 136 0 83 1;
#X connect 141 0 9 0;
#X connect 141 0 245 0;
#X connect 142 0 134 0;
#X connect 145 0 146 0;
#X connect 146 0 149 0;
#X connect 147 0 252 0;
#X connect 148 0 146 0;
#X connect 150 0 45 0;
#X connect 150 0 170 0;
#X connect 151 0 153 0;
#X connect 152 0 155 1;
#X connect 153 0 152 0;
#X connect 154 0 51 0;
#X connect 154 0 66 0;
#X connect 155 0 154 0;
#X connect 156 0 157 1;
#X connect 157 0 50 0;
#X connect 158 0 157 0;
#X connect 160 0 161 0;
#X connect 161 0 156 0;
#X connect 162 0 150 0;
#X connect 163 0 162 1;
#X connect 163 0 164 0;
#X connect 164 0 165 1;
#X connect 165 0 150 0;
#X connect 166 0 167 0;
#X connect 167 0 163 0;
#X connect 169 0 70 0;
#X connect 171 0 89 0;
#X connect 172 0 176 0;
#X connect 172 0 180 0;
#X connect 172 1 177 0;
#X connect 172 1 180 1;
#X connect 172 2 178 0;
#X connect 180 0 181 0;
#X connect 181 0 182 0;
#X connect 181 1 185 0;
#X connect 182 0 183 0;
#X connect 183 0 187 0;
#X connect 185 0 186 0;
#X connect 185 0 188 0;
#X connect 189 0 50 0;
#X connect 193 0 194 0;
#X connect 194 0 198 0;
#X connect 195 0 196 0;
#X connect 195 3 201 0;
#X connect 196 0 197 0;
#X connect 197 0 204 0;
#X connect 197 0 214 0;
#X connect 198 0 195 0;
#X connect 198 1 199 0;
#X connect 198 2 200 0;
#X connect 199 0 202 0;
#X connect 200 0 202 0;
#X connect 202 0 204 0;
#X connect 206 0 207 0;
#X connect 207 0 208 0;
#X connect 208 0 89 0;
#X connect 209 0 210 0;
#X connect 210 0 206 0;
#X connect 211 0 209 0;
#X connect 212 0 213 0;
#X connect 214 0 212 0;
#X connect 217 0 88 0;
#X connect 220 0 222 0;
#X connect 221 0 222 1;
#X connect 222 0 219 0;
#X connect 225 0 226 0;
#X connect 226 0 243 0;
#X connect 227 0 225 0;
#X connect 227 1 226 1;
#X connect 229 0 225 0;
#X connect 235 0 236 0;
#X connect 237 0 235 0;
#X connect 239 0 242 0;
#X connect 242 0 241 0;
#X connect 243 0 155 0;
#X connect 243 1 237 0;
#X connect 244 0 229 0;
#X connect 247 0 97 0;
#X connect 247 1 97 1;
#X connect 249 0 165 0;
#X connect 250 0 162 0;
#X connect 254 0 260 0;
#X connect 255 0 262 0;
#X connect 256 0 301 0;
#X connect 257 0 260 1;
#X connect 258 0 257 0;
#X connect 260 0 255 0;
#X connect 260 1 256 0;
#X connect 261 0 262 1;
#X connect 261 0 316 0;
#X connect 262 0 294 0;
#X connect 263 0 317 0;
#X connect 264 0 284 0;
#X connect 264 0 326 0;
#X connect 265 0 280 0;
#X connect 265 0 285 0;
#X connect 266 0 272 0;
#X connect 275 0 276 0;
#X connect 277 0 278 0;
#X connect 279 0 282 0;
#X connect 280 0 323 0;
#X connect 280 1 279 0;
#X connect 280 1 333 0;
#X connect 280 2 321 0;
#X connect 283 0 287 0;
#X connect 283 0 293 0;
#X connect 284 0 310 0;
#X connect 285 0 312 0;
#X connect 287 0 288 0;
#X connect 288 0 289 0;
#X connect 293 0 313 0;
#X connect 294 0 264 0;
#X connect 294 1 265 0;
#X connect 294 2 283 0;
#X connect 294 3 295 0;
#X connect 295 0 296 0;
#X connect 295 0 299 0;
#X connect 296 0 298 0;
#X connect 298 0 297 0;
#X connect 299 0 314 0;
#X connect 301 0 263 0;
#X connect 301 0 302 0;
#X connect 302 2 303 0;
#X connect 302 3 304 0;
#X connect 302 4 305 0;
#X connect 302 5 306 0;
#X connect 311 0 261 0;
#X connect 316 0 335 0;
#X connect 316 1 336 0;
#X connect 316 2 337 0;
#X connect 316 3 338 0;
#X connect 318 0 319 0;
#X connect 319 0 320 0;
#X connect 321 0 275 0;
#X connect 322 0 321 0;
#X connect 323 0 328 0;
#X connect 324 0 323 0;
#X connect 325 0 324 0;
#X connect 326 0 327 0;
#X connect 326 1 271 0;
#X connect 326 2 266 0;
#X connect 326 3 267 0;
#X connect 326 4 268 0;
#X connect 326 5 269 0;
#X connect 326 6 270 0;
#X connect 327 0 323 1;
#X connect 327 0 321 1;
#X connect 327 0 332 1;
#X connect 328 0 281 0;
#X connect 330 0 322 0;
#X connect 331 0 332 0;
#X connect 332 0 279 0;
#X connect 333 0 332 0;
#X connect 335 0 315 0;
#X connect 335 0 341 0;
#X connect 336 0 315 0;
#X connect 336 0 341 0;
#X connect 337 0 315 0;
#X connect 337 0 341 0;
#X connect 338 0 315 0;
#X connect 338 0 341 0;
#X connect 339 0 340 0;
#X connect 347 0 254 0;
#X connect 353 0 354 0;
#X connect 354 0 62 0;
#X connect 356 0 70 0;
#X connect 357 0 353 0;
#X connect 358 0 70 0;
#X connect 359 0 70 0;
#X connect 360 0 357 0;
#X connect 361 0 362 0;
#X connect 362 0 70 0;
#X connect 363 0 361 0;
#X connect 365 0 358 0;
#X connect 366 0 365 0;
#X connect 372 0 365 0;
#X connect 373 0 359 0;
#X connect 374 0 373 0;
#X connect 375 0 373 0;
#X connect 376 0 72 0;
#X connect 377 0 376 0;
#X connect 378 0 376 0;
#X connect 379 0 356 0;
#X connect 380 0 379 0;
#X connect 381 0 379 0;
#X connect 382 0 169 0;
#X connect 383 0 382 0;
#X connect 384 0 318 0;
#X connect 385 0 384 1;
#X connect 386 0 414 0;
#X connect 387 0 386 0;
#X connect 388 0 390 0;
#X connect 389 0 390 0;
#X connect 390 0 393 0;
#X connect 391 0 382 0;
#X connect 392 0 361 0;
#X connect 394 0 387 0;
#X connect 395 0 400 0;
#X connect 396 0 399 0;
#X connect 397 0 396 0;
#X connect 399 0 402 0;
#X connect 400 0 401 0;
#X connect 402 0 395 0;
#X connect 402 0 398 0;
#X connect 404 0 156 0;
#X connect 407 0 397 0;
#X connect 410 0 412 0;
#X connect 411 0 410 0;
#X connect 412 0 70 0;
#X connect 413 0 410 0;
#X coords 0 -1 1 1 200 128 1 100 100;
